<div>
    <sly-card class="mt15"
              title="Project_mAP"
              subtitle="Project Statistic Table"
              style="min-height: 200px; min-width: 400px; align-self: flex-start;"
    >
        <sly-table v-loading="data.loading"
                   :options="{perPage: 10, pageSizes: [10, 20, 50, 100], fixColumns: 1}"
                   :content="data.tableProjects"
        ></sly-table>
    </sly-card><!--Project_mAP-->
    <sly-card class="mt15"
              title="Datasets_mAP"
              subtitle="Dataset Statistic Table"
              style="min-height: 200px; min-width: 400px; align-self: flex-start;"
    >
        <sly-table v-loading="data.loading"
                   :options="{perPage: 10, pageSizes: [10, 20, 50, 100], fixColumns: 1}"
                   :content="data.tableDatasets"
        ></sly-table>
    </sly-card><!--Dataset_mAP-->
    <sly-card class="mt15"
              title="Image_mAP"
              subtitle="Image Statistic Table"
              style="width: 100%;"
    >
        <sly-table v-loading="data.loading"
                   :options="{perPage: 15, pageSizes: [10, 15, 20, 25, 50, 100], fixColumns: 1}"
                   :content="data.tableImages"
                   @input="state.selection = $event; command('show_images')"
        ></sly-table>
    </sly-card><!--Image_mAP-->
    <sly-card class="mt15"
              title="Original annotation vs Detections"
              subtitle="Select image row in Image_mAP table"
              style="width: 100%;"
    >
        <sly-grid-gallery v-if="state.selection.selectedColumnName"
                          :content="data.previewContent"
                          :options="data.previewOptions">
        </sly-grid-gallery>
    </sly-card><!--Original annotation vs Detections-->
    <sly-card class="mt15"
              title="Precision/Recall Curve"
              subtitle="Precision/Recall Curves for corresponding classes"
              style="min-height: 200px; min-width: 400px; align-self: flex-start;"
    >
        <div class="fflex">
            <sly-table :content="data.tableClasses"></sly-table>
            <sly-line-chart style="flex: 1; align-right: flex-start;"
                            :options.sync="data.lineChartOptions"
                            :content="data.lineChartSeries">
            </sly-line-chart>
        </div>
    </sly-card><!--Precision/Recall Curve-->
    <sly-field title="Sample percent"
               description="how many images should be randomly sampled for evaluation">
        <div class="fflex">
            <el-slider class="ml10 mr10"
                       v-model="state.samplePercent"
                       :min="1"
                       :max="100"
                       @change="state.samplePercent = $event; command('evaluate')"
                       style="flex: 1">
            </el-slider>
            <div class="mr10">{{state.samplePercent}}% / {{Math.round(data.totalImagesCount / 100 * state.samplePercent)}} images</div>
            <el-button class="regular" type="primary" @click="command('evaluate')">Evaluate</el-button>
        </div><!--slider-->
        <div class="fflex">
            <sly-field title="IoU threshold" description="intersection over union threshold values object to be positive selected">
                <el-slider class="ml10 mr10"
                           v-model="state.IoUThreshold"
                           :min="1"
                           :max="100"
                           @change="state.IoUThreshold = $event; command('evaluate')"
                           style="flex: 1">
                </el-slider>
                <div class="mr10">{{state.IoUThreshold}}%</div>
            </sly-field>
            <sly-field title="Score threshold" description="score threshold values object to be positive selected">
                <el-slider class="ml10 mr10"
                           v-model="state.ScoreThreshold"
                           :min="1"
                           :max="100"
                           @change="state.ScoreThreshold = $event; command('evaluate')"
                           style="flex: 1">
                </el-slider>
            </sly-field>
            <div class="mr10">{{state.ScoreThreshold}}%</div>
        </div><!--sliders: IOU,Score-->
    </sly-field><!--slider block-->
    <el-table :data="data.tableClassesExtended" border>
        <el-table-column prop="className" label="name" sortable></el-table-column>
        <el-table-column prop="TP" label="TP" sortable></el-table-column>
        <el-table-column prop="FP" label="FP" sortable></el-table-column>
        <el-table-column prop="npos" label="Count" sortable></el-table-column>
        <el-table-column prop="Recall" label="R" sortable></el-table-column>
        <el-table-column prop="Precision" label="P" sortable></el-table-column>
        <el-table-column prop="AP" label="AP" sortable></el-table-column>
        <el-table-column prop="tag" label="Action">
            <template slot-scope="{ row }">
                <el-button
                        class="regular" type="primary" size="mini"
                        @click="state.selectedClassName = row.className; command('view_class')">
                    Evaluate
                </el-button>
            </template>
        </el-table-column>
    </el-table><!--class Table with Evaluate buttons-->
    <sly-card class="mt15"
              title="Extra Class Info"
              subtitle="Extra Class Info"
              style="min-height: 200px; min-width: 400px;"
    >
        <sly-table :content="data.classExtraStats"></sly-table>
        <div class="fflex">
            <sly-table v-loading="data.loading"
                       :options="{perPage: 15, pageSizes: [10, 15, 20, 25, 50, 100], fixColumns: 1}"
                       :content="data.tableSingleClassImages"
                       @input="state.selection = $event; command('show_images')"
            ></sly-table>
            <sly-line-chart style="flex: 1; align-right: flex-start;"
                            :options.sync="data.lineChartOptions"
                            :content="data.classExtraChartSeries">
            </sly-line-chart>
        </div>

    </sly-card><!--selected class info-->
    <sly-card class="mt15"
              title="Original annotation vs Detections"
              subtitle="Select image row in Image_mAP table"
              style="width: 100%;"
    >
        <sly-grid-gallery v-if="state.selection.selectedColumnName"
                          :content="data.previewContent"
                          :options="data.previewOptions">
            <template v-slot:card-footer="{ annotation }">
                <div class="mt5" style="text-align: center">
                    <el-tag type="primary">{{annotation.info.title}}</el-tag>
                </div>
            </template>
        </sly-grid-gallery>
    </sly-card><!--image grid for selected class-->
    <sly-card class="mt15"
              title="Confusion Matrix"
              subtitle="Select row in Confusion Matrix table"
              style="width: 100%;">
        <sly-table v-loading="data.loading"
                   :options="{perPage: 15, pageSizes: [10, 15, 20, 25, 50, 100], fixColumns: 1}"
                   :content="data.slyTableConfusionMatrix"
                   @input="state.selection = $event; command('show_conf_mtrx_details')"
        ></sly-table>
        Selected cell: {{ state.selected }}
        <sly-confusion-matrix :data="data.slyConfusionMatrix.data"
                              :options="{ selectable: true }"
                              v-model="state.selected">
        </sly-confusion-matrix>
<!--        <el-table :data="data.confusionMatrix.tableData" border style="width: 100%">-->
<!--            <el-table-column prop="class_names" label="class_names" fixed></el-table-column>-->
<!--            <el-table-column v-for="item in data.confusionMatrix.columns"-->
<!--                            :key="item.label"-->
<!--                            :prop="item.prop"-->
<!--                            :label="item.label"-->
<!--                            @cell-click>-->
<!--            </el-table-column>-->
<!--        </el-table>-->
<!--        cell-click	triggers when clicking a cell	row, column, cell, event-->
<!--        <el-table :data="data.confusionMatrix" border>-->
<!--            <el-table-column prop="tag" label="Action">-->
<!--                <template slot-scope="{ row }">-->
<!--                    <el-button-->
<!--                            class="regular" type="primary" size="mini"-->
<!--                            @click="state.selectedClassName = row.className; command('view_class')">-->
<!--                        Evaluate-->
<!--                    </el-button>-->
<!--                </template>-->
<!--            </el-table-column>-->
<!--        </el-table>-->

    </sly-card><!--confusion matrix-->
    <sly-card class="mt15"
              title="Image_mAP"
              subtitle="Image Statistic Table"
              style="width: 100%;"
    >
        <sly-table v-loading="data.loading"
                   :options="{perPage: 15, pageSizes: [10, 15, 20, 25, 50, 100], fixColumns: 1}"
                   :content="data.confusionMatrixImageTable"
                   @input="state.selection = $event; command('show_images')"
        ></sly-table>
    </sly-card><!--Image_mAP-->
    <sly-card class="mt15"
              title="Original annotation vs Detections"
              subtitle="Select image row in Image_mAP table"
              style="width: 100%;"
    >
        <sly-grid-gallery v-if="state.selection.selectedColumnName"
                          :content="data.previewContent"
                          :options="data.previewOptions">
            <template v-slot:card-footer="{ annotation }">
                <div class="mt5" style="text-align: center">
                    <el-tag type="primary">{{annotation.info.title}}</el-tag>
                </div>
            </template>
        </sly-grid-gallery>
    </sly-card><!--image grid for selected class-->
</div>
