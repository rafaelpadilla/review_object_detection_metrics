<sly-card title="Settings"
          subtitle="Base settings: Percentage, IoUThreshold, ScoreThreshold"
          :options="{collapsable: true}"
          :collapsed.sync="state.GlobalSettingsCollapsed"
          :disabled="{disabled: state.GlobalSettingsDisabled, message: 'Please, select classes'}"
          ref="GlobalStep3"
>
    <sly-field title="Sample percent"
               description="Percent of images that will be sampled randomly for metrics evaluation">
        <div class="fflex">
            <el-slider :disablead="data.doneSettings"
                       class="ml10 mr10"
                       style="width: 450px"
                       :min="1"
                       :max="100"
                       v-model="state.samplePercent"
                       show-input
                       @change="state.samplePercent = $event;"
            >
            </el-slider>
            <div class="mr10">{{state.samplePercent}}% / {{Math.round(data.totalImagesCount / 100 *
                state.samplePercent)}} images
            </div>
        </div>
    </sly-field>
    <sly-field title="IoU threshold"
               description="ground truth and prediction boxes are matched if boxes IoU >= selected threshold">
        <div class="fflex">
            <el-slider class="ml10 mr10"
                       style="width: 450px"
                       :min="1"
                       :max="100"
                       v-model="state.IoUThreshold"
                       show-input
                       @change="state.IoUThreshold = $event;"
            >
            </el-slider>
            <div class="mr10">{{state.IoUThreshold}}%</div>
        </div>
    </sly-field>
    <sly-field title="Confidence threshold"
               description="prediction box is skipped if its confidence <= selected threshold"
               class="ml20 mr20"
    >
        <div class="fflex">
            <el-slider class="ml10 mr10"
                       style="width: 450px"
                       :min="1"
                       :max="100"
                       v-model="state.ScoreThreshold"
                       show-input
                       @change="state.ScoreThreshold = $event;"
            >
            </el-slider>
            <div class="mr10">{{state.ScoreThreshold}}%</div>
        </div>
    </sly-field>
    <el-button v-loading="state.loading"
               v-if="!data.doneSettings"
               class="regular"
               type="primary"
               @click="command('evaluate_button_click')">
        Calculate metrics
    </el-button>
    <div v-if="state.DownLoadAnnotations" class="mt10">
        <div style="color: #20a0ff">
            {{state.progressDownLoadAnnotations}}: {{state.progressCurrentDownLoadAnnotations}} /
            {{state.progressTotalDownLoadAnnotations}}
        </div>
        <el-progress :percentage="data.progressPercentUploadDir"></el-progress>
    </div>
    <div v-if="data.doneSettings" class="mt10">
        <div v-if="data.doneSettings">
            <i class="zmdi zmdi-check-circle mr5" style="color: #13ce66"></i>
            <span style="color: #5a6772;">Metrics calculation completed</span>
        </div>
        <el-button type="warning" class="regular mt10" :plain="true"
                   @click="state.restartFrom = 4; command('restart')">
            <i class="zmdi zmdi-rotate-left mr5"></i> Reset settings
        </el-button>
    </div>
</sly-card>